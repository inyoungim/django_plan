/* kmslab_editor 3.0.1 */

!function(){var a=document,b=window,c=a.documentElement;Trex.Class.overwrite(Trex.Tool.FullScreen,{oninitialized:function(){var a=this.editor,b=this.config;if(a.getWrapper()){var c,d=function(){c||(c=new Trex.FullScreen(a,b)),c.execute()};this.executeTool=d,b.switched&&(c||(c=new Trex.FullScreen(a,b)),c.showFullScreen()),this.resetWeave(),this.weave.bind(this)(new Trex.Button(this.buttonCfg),null,d),this.bindKeyboard({ctrlKey:!0,keyCode:77},d),a.observeKey({ctrlKey:!0,altKey:!1,shiftKey:!1,keyCode:77},d)}}}),TrexMessage.addMsg({"@fullscreen.attach.close.btn":Trex._I18N.g("fullscreen.attach.close.btn","파일첨부박스"),"@fullscreen.noti.btn":Trex._I18N.g("fullscreen.noti.btn","일반 글쓰기로"),"@fullscreen.noti.span":Trex._I18N.g("fullscreen.noti.span","넓게쓰기 버튼을 다시 누르시면 처음 글쓰기 창 크기로 돌아갑니다.")}),Trex.MarkupTemplate.add("fullscreen.notice",'<div class="tx-fullscreen-notice"><span>@fullscreen.noti.span</span><a href="#">@fullscreen.noti.btn</a></div>'),Trex.MarkupTemplate.add("fullscreen.linebox",'<div class="tx-fullscreen-line"><div class="tx-fullscreen-line-division"><div class="tx-fullscreen-line-left">&nbsp;</div><div class="tx-fullscreen-line-right">&nbsp;</div></div><div class="tx-fullscreen-line-box"><div class="tx-fullscreen-line-left">&nbsp;</div><div class="tx-fullscreen-line-right">&nbsp;</div><a href="#">@fullscreen.attach.close.btn</a></div></div>'),Trex.FullScreen=Trex.Class.create({initialize:function(a,b){if(a){this.isInit=!1,this.isFullScreen=!1,this.editor=a,this.rootConfig=this.editor.initialConfig,this.wrapper=a.getWrapper(),this.canvas=a.getCanvas(),this.toolbar=a.getToolbar(),this.attachBox=a.getAttachBox(),this.elSavedHiddens=[],this.minHeight=b.minHeight,this.minWidth=b.minWidth,this.useAttachBox=!1,this.isAttachBoxDisplay=!1;var c="tx_fullscreen"+this.rootConfig.initializedId;this._elIcon=$tom.collect($tx(c),"a"),this._title1=Trex._I18N.g("tx_fullscreen-title","확장 (Ctrl + M)"),this._title2=Trex._I18N.g("tx_fullscreen-title-2","축소 (Ctrl + M)");var d=this;this.resizeHandler=function(){d.isFullScreen&&d.resizeContainer()},this.toolbar.observeJob(Trex.Ev.__CMD_ADVANCED_FOLD,this.resizeHandler),this.toolbar.observeJob(Trex.Ev.__CMD_ADVANCED_SPREAD,this.resizeHandler),"function"==typeof showAttachBox&&(this.showAttachBoxAtServiceForSave=showAttachBox),"function"==typeof hideAttachBox&&(this.hideAttachBoxAtServiceForSave=hideAttachBox)}},execute:function(){this.isFullScreen?this.showNormalScreen():this.showFullScreen()},onAttachClick:function(){this.attachClickHandler(!this.isAttachBoxDisplay),this.resizeContainer()},attachClickHandler:function(a){a?(this.showAttachBox(),this.attachBox.fireJobs(Trex.Ev.__ATTACHBOX_FULLSCREEN_SHOW)):(this.hideAttachBox(),this.attachBox.fireJobs(Trex.Ev.__ATTACHBOX_FULLSCREEN_HIDE))},showNormalScreen:function(){if(this._elIcon.title=this._title1,this.isFullScreen){if(this.editor.kEditor&&this.editor.kEditor._eventFullScreen&&!1===this.editor.kEditor._eventFullScreen(!1,!0)){this.isFullScreen=!1;var a=this.wrapper;return void(a&&$tx.removeClassName(a,"tx-editor-fullscreen"))}this._showScrollbar(),this.showNormalScreenAtService();var a=this.wrapper;if(a){if(a.style.width="",$tx.removeClassName(a,"tx-editor-fullscreen"),this.elSavedHiddens.each(function(a){a.style.visibility="visible"}),parent)try{$tx.stopObserving(parent,"resize",this.resizeHandler)}catch(a){}else $tx.stopObserving(window,"resize",this.resizeHandler);this.canvas.setCanvasSize({height:this.panelNormalHeight.toPx()}),this.useAttachBox&&this.attachClickHandler(this.attachBox.checkDisplay()),this.showAttachBoxAtServiceForSave&&(b.showAttachBox=this.showAttachBoxAtServiceForSave),this.hideAttachBoxAtServiceForSave&&(b.hideAttachBox=this.hideAttachBoxAtServiceForSave);for(var c=this.relativeParents.length,d=0;d<c;d+=1){var e=this.relativeParents.pop(),f=this.relativeValues.pop();$tx.setStyle(e,{position:f})}if(this.isFullScreen=!1,!$tx.msie){var g="tx_fullscreen"+this.rootConfig.initializedId;setTimeout(function(){$tom.collect($tx(g),"a").focus()},500)}this.canvas.fireJobs(Trex.Ev.__CANVAS_NORMAL_SCREEN_CHANGE),this.editor.kEditor&&this.editor.kEditor._eventFullScreen&&this.editor.kEditor._eventFullScreen(!1,!1)}}},showFullScreen:function(){this._elIcon.title=this._title2;var c=this;if(!this.isFullScreen){if(this.editor.kEditor&&this.editor.kEditor._eventFullScreen&&!1===this.editor.kEditor._eventFullScreen(!0,!0)){this.isFullScreen=!0;var d=this.wrapper;return void(d&&$tx.addClassName(d,"tx-editor-fullscreen"))}this.isInit||this.generate(),this._hideScrollbar(),this.showFullScreenAtService(),this.showAttachBoxAtServiceForSave&&(b.showAttachBox=function(){c.resizeContainer()}),this.hideAttachBoxAtServiceForSave&&(b.hideAttachBox=function(){c.resizeContainer()});var d=this.wrapper;if(d){$tx.addClassName(d,"tx-editor-fullscreen");var e=[];["select","embed","object"].each(function(b){$A(a.getElementsByTagName(b)).each(function(a){a.style.visibility="hidden",e.push(a)})}),this.elSavedHiddens=e,this.useAttachBox&&this.attachClickHandler(this.attachBox.checkDisplay());var f=this.canvas.getCurrentPanel();this.panelNormalHeight=f.getPosition().height,window.parent?$tx.observe(window.parent,"resize",this.resizeHandler):$tx.observe(window,"resize",this.resizeHandler),b.wrapper=d,this.relativeParents=[],this.relativeValues=[];for(var g=d.offsetParent;g&&g.tagName&&"HTML"!==g.tagName&&"BODY"!==g.tagName;){var h=$tx.getStyle(g,"position");"relative"===h.toLowerCase()&&(this.relativeParents.push(g),this.relativeValues.push(h),$tx.setStyle(g,{position:"static"})),g=g.offsetParent}this.isFullScreen=!0,this.resizeContainer(),this.canvas.fireJobs(Trex.Ev.__CANVAS_FULL_SCREEN_CHANGE),this.editor.kEditor&&this.editor.kEditor._eventFullScreen&&this.editor.kEditor._eventFullScreen(!0,!1)}}},_hideScrollbar:function(){(c.scrollTop||c.scrollLeft)&&(c.scrollTop=0,c.scrollLeft=0),(a.body.scrollTop||a.body.scrollLeft)&&(a.body.scrollTop=0,a.body.scrollLeft=0),c.style.overflow="hidden",a.body.style.overflow="hidden"},_showScrollbar:function(){$tx.msie&&$tx.msie_ver<=8?setTimeout(function(){c.style.overflow="",a.body.style.overflow=""},50):(c.style.overflow="",a.body.style.overflow="")},generate:function(){this.isInit||this.wrapper&&(!0!==this.editor.kEditor.config.hideFullscreenNoti&&this.generateNoti(),this.isInit=!0)},generateNoti:function(){var a=this,b=Trex.MarkupTemplate.get("fullscreen.notice").evaluateAsDom({});$tom.insertFirst(this.wrapper,b);var c=$tom.collect(b,"a");$tx.observe(c,"click",function(){a.isFullScreen?a.showNormalScreen():a.showFullScreen()})},generateLineBox:function(){if(this.useAttachBox){var a=this.canvas.elContainer,b=Trex.MarkupTemplate.get("fullscreen.linebox").evaluateAsDom({});$tom.insertNext(b,a);var c={className:"tx-fullscreen-line-box"};$tx.msie_ver<="5.5"&&(c.align="center");var d=$tom.collect(b,"div.tx-fullscreen-line-box");$tx.msie_ver<="5.5"&&(d.align="center");var e=$tom.collect(d,"a");this.elLineBtn=e,$tx.observe(e,"click",this.onAttachClick.bind(this))}},getAttachBoxPosition:function(){return this.isAttachBoxDisplay?$tom.getPosition(this.attachBox.elBox):{x:0,y:0,width:0,height:0}},getPostAreaBoxPosition:function(){var a=$tx("tx_fullscreen_post_area");return a?$tx.getDimensions(a):{x:0,y:0,width:0,height:0}},resizeContainer:function(){if(!this.isFullScreen)return!1;this.resizeScreenAtService();var a,b;return a=this.getPanelHeight(),this.canvas.setCanvasSize({height:a.toPx()}),this.wrapper&&(b=this.getPanelWidth(),this.wrapper.style.width=b.toPx()),!0},getPanelHeight:function(){var a=0,b=this.canvas.getCanvasPos().y,d=this.useAttachBox?17:0;a=c.clientHeight>0?c.clientHeight-b-d:c.offsetHeight-b-d,a-=this.getPostAreaBoxPosition().height;var e=this.getAttachBoxPosition();return e.height>0&&(a-=e.height+20),Math.max(a,this.minHeight)},getPanelWidth:function(){var a=0;return a=c.clientWidth>0?c.clientWidth:c.offsetWidth,Math.max(a,this.minWidth)},showAttachBox:function(){this.attachBox.useBox&&($tx.addClassName(this.elLineBtn,"tx-attach-close"),$tx.show(this.attachBox.elBox),this.isAttachBoxDisplay=!0)},hideAttachBox:function(){this.attachBox.useBox&&($tx.removeClassName(this.elLineBtn,"tx-attach-close"),$tx.hide(this.attachBox.elBox),this.isAttachBoxDisplay=!1)},showFullScreenAtService:function(){"function"==typeof showFullScreen&&showFullScreen()},showNormalScreenAtService:function(){"function"==typeof showNormalScreen&&showNormalScreen()},resizeScreenAtService:function(){"function"==typeof resizeScreen&&resizeScreen()}});Editor.forEachEditor(function(a){a.getTool().fullscreen.oninitialized()}),Editor.editorForAsyncLoad.getTool().fullscreen.executeTool()}();